# RSASSA-PSS 

see also 
- [PKCS #1 v2.2: RSA Cryptography Standard](https://www.emc.com/collateral/white-papers/h11300-pkcs-1v2-2-rsa-cryptography-standard-wp.pdf)
- [RFC8017 PKCS #1: RSA Cryptography Specifications Version 2.2](https://tools.ietf.org/html/rfc8017)
- [RSA-PSS â€“ Provable secure RSA Signaturesand their Implementation](https://rsapss.hboeck.de/rsapss.pdf)

sample of RSA2048 + SHA256 + RSASSA-PSS

# install 

    $ cpanm -n Crypt::RSA::DataFormat Crypt::OpenSSL::RSA Crypt::OpenSSL::Bignum Digest::SHA 

# prepare test data

    $ openssl genrsa -out rsa_priv.pem 2048
    $ openssl rsa -in rsa_priv.pem -pubout -out rsa_pub.pem

    $ openssl rsa -text -pubin -in rsa_pub.pem
    $ openssl rsa -noout -modulus -pubin -in rsa_pub.pem
    Modulus= A8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613

    $ echo "ababcdcd" | xxd -r -p > src.bin
    $ openssl dgst -sha256 -binary -out src.dgst src.bin

    $ openssl pkeyutl -sign -in src.dgst -inkey rsa_priv.pem -pkeyopt rsa_padding_mode:pss -pkeyopt rsa_pss_saltlen:-1 -pkeyopt digest:sha256 -out src.sig
    $ openssl pkeyutl -verify -pubin -inkey rsa_pub.pem -sigfile src.sig -in src.dgst -pkeyopt rsa_padding_mode:pss -pkeyopt rsa_pss_saltlen:-1 -pkeyopt digest:sha256


# test data
    
    n = 0xA8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613

    e = 0x10001

    $ xxd -p src.sig
    signature = 0x356432c8af1bf8dcea7a3730e308dafb1c581066a5af764eab367c4d418e2ea8aff2075d7e76846f16ec54533135ccd00c3646f1e3285c723a7d0e2033a60ebd7e6ded3d7a90147d480b66fbf965f87fde6e242de3af7934c9082557201cd297fba1ae0ff7ea15fb915bdc22e158fc59b50e3d26f9d7e1eb373ecf06944369c6ba3a5cd82488e8c952f473ab94c5cea851430391cc96cb0420c9994baa56eb4180c6e0c79d86b267f8e65818b458aa6a3006042ef5537c789fe8d1b0b246f0a2b3c12bb1037d9c9cc765f5ec0ab06c9ff837c7e7b1bc121397bc894a309832b9ac3ff0be9e5192839a3074d3b860c6df3922df10b8168d4e8d731f55092f3ffd
    
    $ xxd -p src.dgst
    dgst = 9766183289fb406ed8013e970c8ba6ef743412d77842f187c1bdab488fdae0af

    $ xxd -p src.bin
    src = ababcdcd

# rsassa_pss_verify.pl 
    
    usage: perl rsassa_pss_verify.pl [n] [e] [signature] [mhash] [is_mash=1]

    $ perl rsassa_pss_verify.pl A8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613 10001 356432c8af1bf8dcea7a3730e308dafb1c581066a5af764eab367c4d418e2ea8aff2075d7e76846f16ec54533135ccd00c3646f1e3285c723a7d0e2033a60ebd7e6ded3d7a90147d480b66fbf965f87fde6e242de3af7934c9082557201cd297fba1ae0ff7ea15fb915bdc22e158fc59b50e3d26f9d7e1eb373ecf06944369c6ba3a5cd82488e8c952f473ab94c5cea851430391cc96cb0420c9994baa56eb4180c6e0c79d86b267f8e65818b458aa6a3006042ef5537c789fe8d1b0b246f0a2b3c12bb1037d9c9cc765f5ec0ab06c9ff837c7e7b1bc121397bc894a309832b9ac3ff0be9e5192839a3074d3b860c6df3922df10b8168d4e8d731f55092f3ffd 9766183289fb406ed8013e970c8ba6ef743412d77842f187c1bdab488fdae0af 1

    usage: perl rsassa_pss_verify.pl [n] [e] [signature] [m] [is_mash=undef]
    
    $ perl rsassa_pss_verify.pl A8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613 10001 356432c8af1bf8dcea7a3730e308dafb1c581066a5af764eab367c4d418e2ea8aff2075d7e76846f16ec54533135ccd00c3646f1e3285c723a7d0e2033a60ebd7e6ded3d7a90147d480b66fbf965f87fde6e242de3af7934c9082557201cd297fba1ae0ff7ea15fb915bdc22e158fc59b50e3d26f9d7e1eb373ecf06944369c6ba3a5cd82488e8c952f473ab94c5cea851430391cc96cb0420c9994baa56eb4180c6e0c79d86b267f8e65818b458aa6a3006042ef5537c789fe8d1b0b246f0a2b3c12bb1037d9c9cc765f5ec0ab06c9ff837c7e7b1bc121397bc894a309832b9ac3ff0be9e5192839a3074d3b860c6df3922df10b8168d4e8d731f55092f3ffd ababcdcd

##  verify result  

    n: A8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613
    modBits: 2048
    e: 10001
    signature: 356432c8af1bf8dcea7a3730e308dafb1c581066a5af764eab367c4d418e2ea8aff2075d7e76846f16ec54533135ccd00c3646f1e3285c723a7d0e2033a60ebd7e6ded3d7a90147d480b66fbf965f87fde6e242de3af7934c9082557201cd297fba1ae0ff7ea15fb915bdc22e158fc59b50e3d26f9d7e1eb373ecf06944369c6ba3a5cd82488e8c952f473ab94c5cea851430391cc96cb0420c9994baa56eb4180c6e0c79d86b267f8e65818b458aa6a3006042ef5537c789fe8d1b0b246f0a2b3c12bb1037d9c9cc765f5ec0ab06c9ff837c7e7b1bc121397bc894a309832b9ac3ff0be9e5192839a3074d3b860c6df3922df10b8168d4e8d731f55092f3ffd
    em: 7b8d9bb8c9c40bdb1a9b70cb8b0feca9d29936375ee6c6937daacb367c666663f0b3ff10a43b0c38673a4b7eaaf1963242b6f34a3108f72f38a7eb9da353756ed8ac8b1ccc0ed6852393d8245b263d9dc5959162329e0a79502ca1f4cfb5133e5a975072f957208217e0a8f87af52ee95bc614d76843967ac7508481668fdde1ca6a5339a9d632501229b7e514219f44f4d152262d7391d2cc8e8e56f035e92d5055c20ee031d463c55a2ee9227271f7a2f8cbfa89a5a85a9e9d42f5d2998b454bca1990731265a2336301b121c5413cf6f543b696ee53b82c4e918020af29a9c50a90e1660d1c76b4beb64774b2d2bc71bf12850cd18093396164630ba4ccbc
    emBits: 2047
    mHash: 9766183289fb406ed8013e970c8ba6ef743412d77842f187c1bdab488fdae0af
    maskedDB: 7b8d9bb8c9c40bdb1a9b70cb8b0feca9d29936375ee6c6937daacb367c666663f0b3ff10a43b0c38673a4b7eaaf1963242b6f34a3108f72f38a7eb9da353756ed8ac8b1ccc0ed6852393d8245b263d9dc5959162329e0a79502ca1f4cfb5133e5a975072f957208217e0a8f87af52ee95bc614d76843967ac7508481668fdde1ca6a5339a9d632501229b7e514219f44f4d152262d7391d2cc8e8e56f035e92d5055c20ee031d463c55a2ee9227271f7a2f8cbfa89a5a85a9e9d42f5d2998b454bca1990731265a2336301b121c5413cf6f543b696ee53b82c4e918020af29
    H: a9c50a90e1660d1c76b4beb64774b2d2bc71bf12850cd18093396164630ba4cc
    dbMask: fb8d9bb8c9c40bdb1a9b70cb8b0feca9d29936375ee6c6937daacb367c666663f0b3ff10a43b0c38673a4b7eaaf1963242b6f34a3108f72f38a7eb9da353756ed8ac8b1ccc0ed6852393d8245b263d9dc5959162329e0a79502ca1f4cfb5133e5a975072f957208217e0a8f87af52ee95bc614d76843967ac7508481668fdde1ca6a5339a9d632501229b7e514219f44f4d152262d7391d2cc8e8e56f035e92d5055c20ee031d463c55a2ee9227271f7a2f8cbfa89a5a85a9e9d42f5d2998a15d322d88f024481d72b93e10b95f45ce66abb464ec18510ff9e9e2b6db27c33
    DB: 00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015098e8c11f7156e47518f0e0bab4311dda9c4e05f8576b4347b2d0baed92d31a
    salt: 5098e8c11f7156e47518f0e0bab4311dda9c4e05f8576b4347b2d0baed92d31a
    M': 00000000000000009766183289fb406ed8013e970c8ba6ef743412d77842f187c1bdab488fdae0af5098e8c11f7156e47518f0e0bab4311dda9c4e05f8576b4347b2d0baed92d31a
    H': a9c50a90e1660d1c76b4beb64774b2d2bc71bf12850cd18093396164630ba4cc
    Verify Result: 1

# rsa_decrypt_signature.pl

perl rsa_decrypt_signature.pl [n] [e] [signature]

    $ perl rsa_decrypt_signature.pl A8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613 10001 356432c8af1bf8dcea7a3730e308dafb1c581066a5af764eab367c4d418e2ea8aff2075d7e76846f16ec54533135ccd00c3646f1e3285c723a7d0e2033a60ebd7e6ded3d7a90147d480b66fbf965f87fde6e242de3af7934c9082557201cd297fba1ae0ff7ea15fb915bdc22e158fc59b50e3d26f9d7e1eb373ecf06944369c6ba3a5cd82488e8c952f473ab94c5cea851430391cc96cb0420c9994baa56eb4180c6e0c79d86b267f8e65818b458aa6a3006042ef5537c789fe8d1b0b246f0a2b3c12bb1037d9c9cc765f5ec0ab06c9ff837c7e7b1bc121397bc894a309832b9ac3ff0be9e5192839a3074d3b860c6df3922df10b8168d4e8d731f55092f3ffd
    n: A8EA0544460A30CF9BBF9B292F653EAA4BDAB8D8B9BEE0E8BCBE4456EF94B46B5C3A9514377DB5D4194DD80AC457C45D5FF7CC4493F9EEB0A3CC202024F817730829E249144FD6FB4E29C606E04C9D147F26D6364CC78C8B631F3119EF6FB20E02A4C077FBE5651EB4E4755E9AA14B86FDCD1B95C1E9D56A96E168C9F1ED3B1E06E1B6EC143D38E428D648B1C9AE769D9A249E8DC881A10B06143A935A8B10205330FD8DA405A460B1BAC03AA9EEBC045F57B943EB72FCA6FB4B2F811705AD4145BAFD29CB6DA0CB30EDE1B142B09CD485E472A75CE6ADDD277E095D927087BFC093780DBD6A6F651D9E7F0F744DD2BDABA6AAABFD20D6EFD56244D4C8F6A613
    modBits: 2048
    e: 10001
    signature: 356432c8af1bf8dcea7a3730e308dafb1c581066a5af764eab367c4d418e2ea8aff2075d7e76846f16ec54533135ccd00c3646f1e3285c723a7d0e2033a60ebd7e6ded3d7a90147d480b66fbf965f87fde6e242de3af7934c9082557201cd297fba1ae0ff7ea15fb915bdc22e158fc59b50e3d26f9d7e1eb373ecf06944369c6ba3a5cd82488e8c952f473ab94c5cea851430391cc96cb0420c9994baa56eb4180c6e0c79d86b267f8e65818b458aa6a3006042ef5537c789fe8d1b0b246f0a2b3c12bb1037d9c9cc765f5ec0ab06c9ff837c7e7b1bc121397bc894a309832b9ac3ff0be9e5192839a3074d3b860c6df3922df10b8168d4e8d731f55092f3ffd
    em: 7b8d9bb8c9c40bdb1a9b70cb8b0feca9d29936375ee6c6937daacb367c666663f0b3ff10a43b0c38673a4b7eaaf1963242b6f34a3108f72f38a7eb9da353756ed8ac8b1ccc0ed6852393d8245b263d9dc5959162329e0a79502ca1f4cfb5133e5a975072f957208217e0a8f87af52ee95bc614d76843967ac7508481668fdde1ca6a5339a9d632501229b7e514219f44f4d152262d7391d2cc8e8e56f035e92d5055c20ee031d463c55a2ee9227271f7a2f8cbfa89a5a85a9e9d42f5d2998b454bca1990731265a2336301b121c5413cf6f543b696ee53b82c4e918020af29a9c50a90e1660d1c76b4beb64774b2d2bc71bf12850cd18093396164630ba4ccbc
