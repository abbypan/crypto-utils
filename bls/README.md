# bls

## install

https://github.com/herumi/bls/

## test

    make

    ./bls12_381_keygen

    ./bls12_381_export_pubkey [seckey]

    ./bls_sign [seckey] [msg]

    ./bls_verify [pubkey] [msg] [sig]
    
    ./bls_multi_sign [msg] [seckey1] [seckey2] ... [seckey20]
    
    ./bls_threshold_sign [msg]

## test vector

    $ ./bls12_381_keygen
    3a7ece9eb51007657dcd7593286b42b5f4630ebc3c708fcb8eea701f196a689f
    
    $ ./bls12_381_keygen
    207b84a664af5ec5be901bca7657806d50a0f763484059673af783ab5acae82b

    $ ./bls_multi_sign justfortest 3a7ece9eb51007657dcd7593286b42b5f4630ebc3c708fcb8eea701f196a689f 207b84a664af5ec5be901bca7657806d50a0f763484059673af783ab5acae82b
    sec (32): 3a7ece9eb51007657dcd7593286b42b5f4630ebc3c708fcb8eea701f196a689f
    pub (288): 1 7a81f1063684e4ec71c72d8ad53d1f3c1470fb8d90a10d858807a1f18811e24633920a7c7b0aebc964c689b21c48c2e 1310581480601a887d3b4acf75ab39fe8f2b2ced34a5fea45f135e35463266462ce9e3102d7e890b145723484a342e15 11a92668f2fdbc0e1e21de6ca4c9f88a523c0df724dad856a0f6c14d9b84f807769d2e07a570b52181b7ce46ee459b88 152327b84e822cd28057e65751f116c42f8559e79ea72ade7110d04c9c542e31a6816d029ced389edf8029d56540c0c9
    sig (144): 1 1395d1137cbc5ec30c9a446ebe6c656d562baf59ccea0e96351ce89fba5b7634a096dfe43a1aa7279418fe7a17c7a74f 15848ad7a3b3a369685495e46c95b032a04815fabe86e7b95ded3a3e04ad22e76a2e071fd6af1ddc0ff0148ce3a17c05

    sec (32): 207b84a664af5ec5be901bca7657806d50a0f763484059673af783ab5acae82b
    pub (288): 1 116da86a439e3319258942986712cd0b68d6b07f686fe60b7023645505b932ea6db84b4e25d47b2faa357b7333e15b1f 1a06a4765b664787dc9cb90fb4a015c65c2e8404355c2ed8a34fa584bd99f60684141f9cf4aeb7d819ff0a65557b636 9739357d824acedb77fe15fbecade406673f5de35c6bbb6d54c287aa6b44d33e3aed0e1505fd07f4a4a0d0028b47ae2 1015cc0a2a6aea454291dbb3bd1c359c73d204bf744e208ede661db1561800b9387629fb3d99fde05a26eabec928af14
    sig (144): 1 5888ff93235d0b32f314b440fedc641cb756812351105030e1b3b9580b4493fd323f9adfaa017acecee376c9a57be11 105ecca83b8d4deac6ba47b6d8bffbe4ab1d43f45e086293fd358f718c943da65618f420c39cbbd115d1097277f5fb54

    aggPub (288): 1 14b8609beb736e4400fc17edde9c71528970d186df7a7d982b5b61662402a36e2ea520473142f1d5283fd6a0fbabf8f 88ee491bdc515f936ff28cbda471d8e9696d2288eb8e2b7342447ddd0dac1c59125fd2eba24979ce1996df57308f07b 12cf41d3d9800a5d07a5b8472889c6da7a8ee3fbef8a1d135e24af6fb2aa48a91357ce8eff91a5dacfe8dfb380dee32c 17f7561da3d9de554f20d70535b49345976888e3c4f328dcd76b707271dfca4c4ea12c40f99c06c2bab0bd7a449598b7
    aggSig (144): 1 a5a7e8e9a6fbce6a63d43d2ef05f62e23caf16091877c8176a0a7076365e05fe4c3cd08ba28b65c1177260b6874842d 13c955a09d7aa2b6783115028a55291411c2fb42cc201df601e3bbf68e6442d8c1fd2fba1509c65ee12e8f6df801eec3
    aggVerify: 1

    $ ./bls_threshold_sign justfortest
    shared secret 0: 1d357b1d585978364a2a8bfbc5203cdfe9465565fa597bf3f0bcb74fbc8d4e32
    shared secret 1: 713c440afdba48521acc1981a3ee164f29b06917a1352402ad7ea2d9101c70a4
    shared secret 2: fc3255c5bf61b3aff0ee4bb947a810d40b29016e896057e26a83f43006870c6
    shared secret 3: 5493150aefe568c990a075c1b3ab052a2985b66cd07734635c398c8a8d714e9b
    shared secret 4: 57d0c470664d366d690d1c83ee3bf29b3cae941358dbf8b44e328ab1b7370a21
    msk: 6f77c08ce8ac22c026d7c44214f67ccf7aad410af3fe214ef0627ca405bb0973

    shared pub key 0: 1 77e980de6ae25cb74efbd3681e6cd4c28a7a5e98ffbe36181af69a7523772ad4e23b2b946d43032766ee9256ba4339e 430114ce4b1977d5b264212c20a02b7e6d4923c18af1836bb571b0054e64245d658fdfdd12f00742257da66846e8d9e 15453c100648a2ac33402b6e452f20faf7b4b6e288ac839d8534394c5eaf09f7bef1d2a7d8c9c74d44d3f3649a2e14fc 117bc856e8710b82d891f14d5e30bdc5bb03741fbf8550e7177edcfa9f752f1d9eb36737ecb98f5ff32a88ea71094932
    shared pub key 1: 1 1280f702bd45b4bb59bfc60a60ee3e05f46a34334f0d4a10817fb1b70a7db93da79c152578e339eb7e32fe3ac0cde059 28b20150509159c321136d3ea815e26c92c392a862b4cd97c8502f14a1c2f397a70d7a50482fb8b37bd26d7a6e3090 b9176193b5655e9ae80fc8910c9cb2c8a5b207ddc4a8cd212d682c93ce7e1659245b5fcc8100e31dec3a063e4eae5cf e634f118ba030569d5d173572bc79f6c0d8751a92d7df6d26529f9a52f9643214d813ebb6f37fe15a1dd045478b43b0
    shared pub key 2: 1 ea7a3e1ce20551181f52ff55dc18b8e54d16811d1c98f69ba5db16334edf4855304081a4a42c2999b72e6efd4b14b70 ccb8e6be6157fd7575e98fb899de31b422f85fe13a3fab988604e31d881337af8f8013c37e94e2bee158e615c6caa05 18f783fcb4482ed8c4772164dc0f55a934bce2e236d91d86ae7a5a96f82f38dfa94ab2f19ce6fa41d76ed28d887299ea 14c56856976a5ceea196aa76c6a2fad4cdf7ad1842b37ca3986264e841b8619232537ec5ad840b4d6e6f148a6511c243
    shared pub key 3: 1 16ae2fcbec63774fd333407d8a17163d687020a8d929a3085b1595c8acc4ca1e38a656d4d06fdf2b7a8b14293877b794 10b4d41ad4d215636e092928a8e2c13a0f77a52a01c2e596d078d1de4d5c3c20c29f23f6aa415fcc43763c43bcb2999c e59e6d16c0636c03b72d815e9c10782703308bb7a515f5849e93a9cff4fc055cb248243dcd51da5424d486853ee83ef 19b34d41b0b9246a0630c73bfacae65b0a47c0fad1987031e0a24eae8839ff3f0a050ad60a009a5f364fb0279f61adce
    shared pub key 4: 1 d0f272cbea18bde1a27b1cc9ec0cb26f94946c29da0efcff04288375719b2b394bce6bd01a700ae1f895d7cc6a42ca7 17b8852161527e79e142cbdcb6f380c789cb0c8f20a2039200e6e36b8eaa8826375ba288dce3cc47743e0ade49a30d58 1095423c5c161cca42da8551bd360f53c888f76a1d04f734c59c1022a1c23a8d8a9a690f62fb78953a6e0edba2a015b9 50aca353346586be446bd09b6371049fddc6bd2243c2b0d07d498cebd91b1c42415c3e99fa5b9deb621cec448c6a99
    mpk: 1 12f0ea78f0a4a8245eb035ec2ee5666940e7ccd47b3108bbc89a658ca2c32d4aa73a7a8a7d96457230f61b392bcd1b1 6eae478472343ef9aa138bc212ccb51791917eb027e6d7e09d768a017d5e1c94878157a90ce8df445478c276ce1b2f3 114fc0814364219740641f0b30c04ecdd7ea73b1f20a44b08d3354c23c60718668d8eb5a9013ef54b10f06102d4ee306 108edd7c3944257fe54c133fa2bd6c63644db5fc940d84e7ad1f7aac421e61a3c86e1436249c0692a7febdbe7d1d9973

    shared sig 0: 1 2f73e4d268e4a09bbfdaa9df91348a8df24e44030fc7288b14e3b6ef08904874c71d6a50078455a65148267cbfa92a6 83771f95ae30f1fa37066a16eb3b1ade06ec1bcd990ee38cca8c6824dc0458cadf3c588df138fa0571aec31f588a4d3
    shared sig 1: 1 17de80610016c76a46d6f6f369bd0632ebdc593b9675877a43fdd3409ea70aea30afd8066f7cd4589d3843aa5de3327f 147e4485c80c02af1060b4e0443b1c8d0cbf289c95b3404816694f31b3783c08fc6d77ae6ad0deec5f336ea00cbdbe57
    shared sig 2: 1 7f10f3698e711dfa0bc0ea6aa45b3f8c2c5512f6f56b540cdc41dada96771d037a4027c7a1ca0d00a11496dcf1e8b3f 4ea244e482a6c3ebe29ec9f092c0888acb040e70bf065ff9ed610567a041a95c4ec59268cb199c27de95ff991ba8f4d
    shared sig 3: 1 15536c87e46a20c8ef375d443f8b433fb93e4458825e53547985783021a5b963877659203d1e0c60131ef2f6e5d18b58 186dbdb405f41fa6bffb90a09dc1b76ddbe93bce2cf073a0d08200a999f3eee9254ee812173eb95f20654e3e1dea094f
    shared sig 4: 1 3ca4a7506edf2667c21de60b592ce197a7d2cd568c542f69df7cfef11835294bb6a7290642aaababe6876363c903b58 4d00b64e985504e211a36ccc908b7e46699d72dcdf54885aa670da238cfd15b255e47cc5dd6c012f399e2d3082a51e8
    
    recover sig: 1 aa9449fe05e31ddaaf232cb395c2bc8a73dd8e834fa184522056d40713af7224d94fe407e40f8dcaff188827d1f3a7c c1e5b8da8119ae9f4b6ef0b09a1f81862e2ca346b50e03857ee17981bfdec47ff9dd92f790d8481ec131af343fc74e1
    thresVerify: 1

